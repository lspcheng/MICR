---
title: "MICR AXB Combined Statistics"
output: html_notebook
---

# Data Preparation

# Statistics
## Single-Point Regression
### Prepare DFs
```{r}
# Prep Data for Analysis

# Add contrast variables
axbdata.coded <- axb_all_data %>% filter(speaker=='S3') %>%
  mutate(item = as.factor(item),
         
    # Create step-as-factor variable 
        step.f=as.factor(step),
         
    # Deviation/Sum coding (compare to mean of factor)
         MI.CN=case_when(speakerGuise=='MI' ~ -0.5,
                         speakerGuise=='CN' ~ 0.5,
                         TRUE ~ 0),
         BL.CN=case_when(speakerGuise=='BL' ~ -0.5,
                         speakerGuise=='CN' ~ 0.5,
                         TRUE~0),
         BL.MI=case_when(speakerGuise=='BL' ~ -0.5,
                         speakerGuise=='MI' ~ 0.5,
                         TRUE~0),
    
    # Treatment/Baseline coding (compare to reference group)
        guiseCN=case_when(speakerGuise=='CN' ~ 1,
                         TRUE~0),
        guiseMI=case_when(speakerGuise=='MI' ~ 1,
                         TRUE~0))
  
  # Select and reorder relevant columns
  # select(experimentId, participantId:EQscore_all, respRS, raised_response, rt, rt_sec, 
  #        item, vowel, step, speakerGuise, speaker, word, speakerOrder, conditionId, guiseName, 
  #        step.f, guiseCN, guiseMI, BL.CN, BL.MI, MI.CN,)
```

```{r, eval=F}
# Get grand mean of propRS
axbdata.coded %>% filter(step==0) %>% filter(vowel=='AU') %>%
  group_by(experimentId, speakerGuise, vowel) %>% 
  summarize(meanlogRS = logit(mean(respRS)), selogRS = std.error(logit(respRS)),  meanRS = mean(respRS), seRS = std.error(respRS))


# Get grand mean of propRS
axbdata.coded %>% filter(step==0) %>% filter(vowel=='AU') %>%
  group_by(speakerGuise, vowel) %>% 
  summarize(meanlogRS = logit(mean(respRS)), selogRS = std.error(logit(respRS)),  meanRS = mean(respRS), seRS = std.error(respRS))

```

### Basic Binomial Regression 

#### Exp 1a
```{r}
# Old (1a) dataset
axb.glm.au <- glmer(respRS ~ speakerGuise + (1 | participantId) + (1 | item),
                    family = "binomial", 
                    control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)),
                    data = axbdata.coded %>% filter(step == "0") %>% filter(vowel=='AU') %>% filter(experimentId=="1a")) 

summary(axb.glm.au)
```

#### Exp 1b
```{r}
# New (1b) dataset
axb.glm.au <- glmer(respRS ~ speakerGuise + (1 | participantId) + (1 | item),
                    family = "binomial", 
                    control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)),
                    data = axbdata.coded %>% filter(step == "1") %>% filter(vowel=='AU')  %>% filter(experimentId=="1b")) 
summary(axb.glm.au)
```

#### Combined
```{r}
# Pooled dataset
axb.glm.au <- glmer(respRS ~ speakerGuise + (1 | participantId) + (1 | item),
                    family = "binomial", 
                    control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)),
                    data = axbdata.coded %>% filter(step == "-1") %>% filter(vowel=='AU')) 
summary(axb.glm.au)
```

```{r}
# Pooled dataset
axb.glm.au <- glmer(respRS ~ speakerGuise + (1 | participantId) + (1 | item),
                    family = "binomial", 
                    control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)),
                    data = axbdata.coded %>% filter(step == "1") %>% filter(vowel=='AU')) 
summary(axb.glm.au)
```

```{r}
# Pooled dataset
axb.glm.au <- glmer(respRS ~ speakerGuise + (1 | participantId) + (1 | item),
                    family = "binomial", 
                    control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)),
                    data = axbdata.coded %>% filter(step == "0") %>% filter(vowel=='AU')) 
summary(axb.glm.au)

fixef(axb.glm.au)
```

## IndScore Regression (Step 1)

### Prepare DFs
```{r}
fixef(axb.glm.au)[[1]]

axb_ind_data <- axbdata.coded %>% filter(step==1) %>% filter(vowel=='AU') %>% group_by(participantId, speakerGuise) %>%
  summarize(meanRS_prop = mean(respRS),
            meanRS_logOdds = logit(mean(respRS))) %>% 
  mutate(BLint_logOdds = fixef(axb.glm.au)[[1]]) %>%
  mutate(BLint_prop = inv_logit_scaled(BLint_logOdds)) %>%
  
  mutate(guiseBias_prop = ifelse(speakerGuise=='MI', -(meanRS_prop - BLint_prop), (meanRS_prop - BLint_prop))) %>%
  mutate(guiseBias_logOdds = ifelse(speakerGuise=='MI', -(meanRS_logOdds - BLint_logOdds), (meanRS_logOdds - BLint_logOdds))) %>%
  relocate(guiseBias_prop, .after=speakerGuise)

axb_ind_data
```

### GuiseBias Check

#### Midpoint PropRS by Ind
```{r fig.width=10}
# Density plot
axb_ind_data %>% ggplot(aes(x=meanRS_prop, color=speakerGuise, fill=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_density(alpha=0.3) +
  labs(x="Observed Proportion 'Raised'", color = "Guise", fill="Guise")

# Scatterplot
axb_ind_data %>% ggplot(aes(x=participantId, y=meanRS_prop, color=speakerGuise)) %>% 
  guise_colors() +
  gg_theme() +
  geom_point(size=5, alpha=0.7) + 
  geom_abline(aes(slope=0, intercept = BLint_prop)) +
  facet_grid(~speakerGuise) +
  labs(y="Observed Proportion 'Raised'", x = "Participant", color = "Guise")


# Boxplot
axb_ind_data %>% ggplot(aes(x=speakerGuise, y=meanRS_prop, color=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_violin(aes(fill = speakerGuise, color=speakerGuise), alpha=0.3, na.rm=TRUE) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=5, alpha=0.3)
  

```

#### Midpoint GuiseBias by Ind
```{r fig.width=10}
# Density plot
axb_ind_data %>% ggplot(aes(x=guiseBias_prop, color=speakerGuise, fill=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_density(alpha=0.3) +
  labs(x="Guise Bias", color = "Guise", fill="Guise")

# Scatterplot
axb_ind_data %>% ggplot(aes(x=participantId, y=guiseBias_prop, color=speakerGuise)) %>% 
  guise_colors() +
  gg_theme() +
  geom_point(size=5, alpha=0.7) + 
  geom_abline(aes(slope=0, intercept = 0)) +
  facet_grid(~speakerGuise) +
  labs(y="Guise Bias", x = "Participant", color = "Guise")

# Boxplot
axb_ind_data %>% ggplot(aes(x=speakerGuise, y=guiseBias_prop, color=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_violin(aes(fill = speakerGuise, color=speakerGuise), alpha=0.3, na.rm=TRUE) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=5, alpha=0.3)


```

### Individual Regression
```{r}
# Only including mid-point currently
axbdata_ind.coded <- axbdata.coded %>% 
  filter(step == "1") %>% filter(vowel=='AU') %>% 
  merge(., axb_ind_data) %>%
  mutate(genderContr = case_when(Gender=="f" ~ -0.5,
                                  Gender=="m" ~ 0.5,
                                 TRUE ~ 0),
         guiseContr = case_when(speakerGuise=="CN" ~ -0.5,
                                speakerGuise=="MI" ~ 0.5)) %>%
  mutate_if(is.character, as.factor)

# colnames(axbdata_ind.coded)
# summary(axbdata_ind.coded)
```

#### 1b
##### Basic
```{r}
lm.ind <- lm(guiseBias_prop ~ genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```
##### With CE
```{r}
lm.ind <- lm(guiseBias_prop ~ CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```
##### With Age
```{r}
lm.ind <- lm(guiseBias_prop ~ Age + CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```

#### Combined
##### Basic
```{r}
lm.ind <- lm(guiseBias_prop ~ genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

##### With CEscore
```{r}
lm.ind <- lm(guiseBias_prop ~ CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

##### With Age
```{r}
lm.ind <- lm(guiseBias_prop ~ Age + CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

### Plots

#### Categorical Plots
```{r}
# Boxplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>%
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=Gender, y=guiseBias_prop, color=Gender)) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  # geom_violin(aes(fill = Gender, color=Gender), alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=2, alpha=0.3) +
  geom_boxplot(aes(fill = Gender), width=0.5, alpha=0.3, na.rm=TRUE) 
  
```

```{r}
# Boxplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=speakerGuise, y=guiseBias_prop, color=speakerGuise)) +
  gg_theme() +
  # geom_violin(aes(fill = Gender, color=Gender), alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=2, alpha=0.3) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) 
  
```



#### Continuous Plots
```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=speakerGuise, shape=speakerGuise)) +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F) 

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  # ggplot(aes(x=EQscore_all, y=guiseBias_prop))  +
  ggplot(aes(x=EQscore_all, y=guiseBias_prop, color=speakerGuise))  +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(aes(color=speakerGuise, shape=speakerGuise), size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>%
  ggplot(aes(x=CEscore_all, y=guiseBias_prop))  +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  geom_point(aes(color=speakerGuise),size=2, alpha=0.5) +
  geom_smooth(method='lm')

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>%
  ggplot(aes(x=Age, y=guiseBias_prop)) +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  geom_point(aes(color=speakerGuise),size=5, alpha=0.5) +
  geom_smooth(method='lm')

```


#### Interaction
```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  mutate(EQgroups.3 = as.numeric(cut(EQscore_all, 3))) %>%
  mutate(EQgroups.3 = case_when(EQgroups.3 == 1 ~ "low",
                                EQgroups.3 == 2 ~ "mid",
                                EQgroups.3 == 3 ~ "high")) %>%
  relocate(EQgroups.3, .after=Ethnicity) %>%
  mutate(EQgroups.3 = factor(EQgroups.3, levels  = c("high", "mid", "low"))) %>%
  
  # group_by(EQgroups.3) %>% summarize(n=n(), meanEQ = mean(EQscore_all),min = min(EQscore_all),max = max(EQscore_all), range=max(EQscore_all)-min(EQscore_all))
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.3))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(5,6,7)])+
  gg_theme() +
  facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)
```

```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  mutate(EQgroups.3 = as.numeric(cut_number(EQscore_all, 3))) %>%
  mutate(EQgroups.3 = case_when(EQgroups.3 == 1 ~ "low",
                                EQgroups.3 == 2 ~ "mid",
                                EQgroups.3 == 3 ~ "high")) %>%
  relocate(EQgroups.3, .after=Ethnicity) %>%
  mutate(EQgroups.3 = factor(EQgroups.3, levels  = c("high", "mid", "low"))) %>%
  
  # group_by(EQgroups.3) %>% summarize(n=n(), meanEQ = mean(EQscore_all),min = min(EQscore_all),max = max(EQscore_all), range=max(EQscore_all)-min(EQscore_all))
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.3))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(5,6,7)])+
  gg_theme() +
  facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)


```

```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>% mutate(EQgroups.4 = as.numeric(cut_number(EQscore_all, 4))) %>%
  mutate(EQgroups.4 = case_when(EQgroups.4 == 1 ~ "low",
                                EQgroups.4 == 2 ~ "mid-low",
                                EQgroups.4 == 3 ~ "mid-high",
                                EQgroups.4 == 4 ~ "high")) %>%
  relocate(EQgroups.4, .after=Ethnicity) %>%
  mutate(EQgroups.4 = factor(EQgroups.4, levels  = c("high", "mid-high", "mid-low", "low"))) %>%
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.4))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(2,5,6,7)])+
  gg_theme() +
  facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)


```

## IndScore Regression (Step -1)

### Prepare DFs
```{r}
fixef(axb.glm.au)[[1]]

axb_ind_data <- axbdata.coded %>% filter(step==-1) %>% filter(vowel=='AU') %>% group_by(participantId, speakerGuise) %>%
  summarize(meanRS_prop = mean(respRS),
            meanRS_logOdds = logit(mean(respRS))) %>% 
  mutate(BLint_logOdds = fixef(axb.glm.au)[[1]]) %>%
  mutate(BLint_prop = inv_logit_scaled(BLint_logOdds)) %>%
  
  mutate(guiseBias_prop = ifelse(speakerGuise=='MI', -(meanRS_prop - BLint_prop), (meanRS_prop - BLint_prop))) %>%
  mutate(guiseBias_logOdds = ifelse(speakerGuise=='MI', -(meanRS_logOdds - BLint_logOdds), (meanRS_logOdds - BLint_logOdds))) %>%
  relocate(guiseBias_prop, .after=speakerGuise)

axb_ind_data
```

### GuiseBias Check

#### Midpoint PropRS by Ind
```{r fig.width=10}
# Density plot
axb_ind_data %>% ggplot(aes(x=meanRS_prop, color=speakerGuise, fill=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_density(alpha=0.3) +
  labs(x="Observed Proportion 'Raised'", color = "Guise", fill="Guise")

# Scatterplot
axb_ind_data %>% ggplot(aes(x=participantId, y=meanRS_prop, color=speakerGuise)) %>% 
  guise_colors() +
  gg_theme() +
  geom_point(size=5, alpha=0.7) + 
  geom_abline(aes(slope=0, intercept = BLint_prop)) +
  facet_grid(~speakerGuise) +
  labs(y="Observed Proportion 'Raised'", x = "Participant", color = "Guise")


# Boxplot
axb_ind_data %>% ggplot(aes(x=speakerGuise, y=meanRS_prop, color=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_violin(aes(fill = speakerGuise, color=speakerGuise), alpha=0.3, na.rm=TRUE) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=5, alpha=0.3)
  

```

#### Midpoint GuiseBias by Ind
```{r fig.width=10}
# Density plot
axb_ind_data %>% ggplot(aes(x=guiseBias_prop, color=speakerGuise, fill=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_density(alpha=0.3) +
  labs(x="Guise Bias", color = "Guise", fill="Guise")

# Scatterplot
axb_ind_data %>% ggplot(aes(x=participantId, y=guiseBias_prop, color=speakerGuise)) %>% 
  guise_colors() +
  gg_theme() +
  geom_point(size=5, alpha=0.7) + 
  geom_abline(aes(slope=0, intercept = 0)) +
  facet_grid(~speakerGuise) +
  labs(y="Guise Bias", x = "Participant", color = "Guise")

# Boxplot
axb_ind_data %>% ggplot(aes(x=speakerGuise, y=guiseBias_prop, color=speakerGuise)) %>%
  guise_colors() +
  gg_theme() +
  geom_violin(aes(fill = speakerGuise, color=speakerGuise), alpha=0.3, na.rm=TRUE) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=5, alpha=0.3)


```

### Individual Regression
```{r}
# Only including mid-point currently
axbdata_ind.coded <- axbdata.coded %>% 
  filter(step == "-1") %>% filter(vowel=='AU') %>% 
  merge(., axb_ind_data) %>%
  mutate(genderContr = case_when(Gender=="f" ~ -0.5,
                                  Gender=="m" ~ 0.5,
                                 TRUE ~ 0),
         guiseContr = case_when(speakerGuise=="CN" ~ -0.5,
                                speakerGuise=="MI" ~ 0.5)) %>%
  mutate_if(is.character, as.factor)

# colnames(axbdata_ind.coded)
# summary(axbdata_ind.coded)
```

#### 1b
##### Basic
```{r}
lm.ind <- lm(guiseBias_prop ~ genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```
##### With CE
```{r}
lm.ind <- lm(guiseBias_prop ~ CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```
##### With Age
```{r}
lm.ind <- lm(guiseBias_prop ~ Age + CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded %>% filter(experimentId=='1b'))
summary(lm.ind)
```

#### Combined
##### Basic
```{r}
lm.ind <- lm(guiseBias_prop ~ genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

##### With CEscore
```{r}
lm.ind <- lm(guiseBias_prop ~ CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

##### With Age
```{r}
lm.ind <- lm(guiseBias_prop ~ Age + CEscore_all + genderContr + guiseContr + 
               SAscore_all * EQscore_all +
               guiseContr:SAscore_all + guiseContr:EQscore_all + guiseContr:SAscore_all:EQscore_all,
             data=axbdata_ind.coded)
summary(lm.ind)
```

### Plots

#### Categorical Plots
```{r}
# Boxplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>%
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=Gender, y=guiseBias_prop, color=Gender)) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  # geom_violin(aes(fill = Gender, color=Gender), alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=2, alpha=0.3) +
  geom_boxplot(aes(fill = Gender), width=0.5, alpha=0.3, na.rm=TRUE) 
  
```

```{r}
# Boxplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=speakerGuise, y=guiseBias_prop, color=speakerGuise)) +
  gg_theme() +
  # geom_violin(aes(fill = Gender, color=Gender), alpha=0.3, na.rm=TRUE) +
  geom_jitter(size=2, alpha=0.3) +
  geom_boxplot(aes(fill = speakerGuise), width=0.5, alpha=0.3, na.rm=TRUE) 
  
```



#### Continuous Plots
```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop)) +
  # ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=speakerGuise, shape=speakerGuise)) +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F) 

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  ggplot(aes(x=EQscore_all, y=guiseBias_prop))  +
  # ggplot(aes(x=EQscore_all, y=guiseBias_prop, color=speakerGuise))  +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(aes(color=speakerGuise, shape=speakerGuise), size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>%
  ggplot(aes(x=CEscore_all, y=guiseBias_prop))  +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  geom_point(aes(color=speakerGuise),size=2, alpha=0.5) +
  geom_smooth(method='lm')

```

```{r}
# Scatterplot
axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>%
  ggplot(aes(x=Age, y=guiseBias_prop)) +
  scale_color_manual(values=ghibli_palette("PonyoMedium")[c(4,3)]) +
  gg_theme() +
  geom_point(aes(color=speakerGuise),size=5, alpha=0.5) +
  geom_smooth(method='lm')

```


#### Interaction
```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  mutate(EQgroups.3 = as.numeric(cut(EQscore_all, 3))) %>%
  mutate(EQgroups.3 = case_when(EQgroups.3 == 1 ~ "low",
                                EQgroups.3 == 2 ~ "mid",
                                EQgroups.3 == 3 ~ "high")) %>%
  relocate(EQgroups.3, .after=Ethnicity) %>%
  mutate(EQgroups.3 = factor(EQgroups.3, levels  = c("high", "mid", "low"))) %>%
  
  # group_by(EQgroups.3) %>% summarize(n=n(), meanEQ = mean(EQscore_all),min = min(EQscore_all),max = max(EQscore_all), range=max(EQscore_all)-min(EQscore_all))
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.3))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(5,6,7)])+
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)
```

```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup()  %>% 
  filter(speakerGuise!="BL") %>%
  # filter(experimentId=='1b') %>%
  
  mutate(EQgroups.3 = as.numeric(cut_number(EQscore_all, 3))) %>%
  mutate(EQgroups.3 = case_when(EQgroups.3 == 1 ~ "low",
                                EQgroups.3 == 2 ~ "mid",
                                EQgroups.3 == 3 ~ "high")) %>%
  relocate(EQgroups.3, .after=Ethnicity) %>%
  mutate(EQgroups.3 = factor(EQgroups.3, levels  = c("high", "mid", "low"))) %>%
  
  # group_by(EQgroups.3) %>% summarize(n=n(), meanEQ = mean(EQscore_all),min = min(EQscore_all),max = max(EQscore_all), range=max(EQscore_all)-min(EQscore_all))
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.3))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(5,6,7)])+
  gg_theme() +
  # facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)


```

```{r}

axbdata_ind.coded %>% group_by(participantId) %>% filter(time_elapsed == min(time_elapsed)) %>% ungroup() %>% filter(speakerGuise!="BL") %>% mutate(EQgroups.4 = as.numeric(cut_number(EQscore_all, 4))) %>%
  mutate(EQgroups.4 = case_when(EQgroups.4 == 1 ~ "low",
                                EQgroups.4 == 2 ~ "mid-low",
                                EQgroups.4 == 3 ~ "mid-high",
                                EQgroups.4 == 4 ~ "high")) %>%
  relocate(EQgroups.4, .after=Ethnicity) %>%
  mutate(EQgroups.4 = factor(EQgroups.4, levels  = c("high", "mid-high", "mid-low", "low"))) %>%
  
  ggplot(aes(x=SAscore_all, y=guiseBias_prop, color=EQgroups.4))  +
  scale_color_manual(values=ghibli_palette("MononokeMedium")[c(2,5,6,7)])+
  gg_theme() +
  facet_grid(~speakerGuise) +
  geom_point(size=2, alpha=0.5) +
  geom_smooth(method='lm', se=F)


```